<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>CBA · Formulario de Carga</title>
  <meta name="description" content="Formulario CBA para registrar Wellness y RPE">
  <style>
    :root{--bg:#f6f7fb;--panel:#fff;--border:#e5e7eb;--text:#111827;--muted:#6b7280;--blue:#2563eb;--blue2:#1d4ed8}
    *{box-sizing:border-box} html,body{margin:0}
    body{font:14px/1.45 ui-sans-serif,system-ui,Segoe UI,Roboto,Helvetica,Arial;background:var(--bg);color:var(--text)}
    .wrap{max-width:920px;margin:32px auto;padding:0 16px}
    .card{background:var(--panel);border:1px solid var(--border);border-radius:12px;box-shadow:0 1px 2px rgba(0,0,0,.06);padding:20px;margin-bottom:16px}
    h1{margin:0 0 6px;font-size:24px} h2{margin:8px 0 12px;font-size:18px}
    .muted{color:var(--muted)}
    label{display:block;font-weight:600;margin:14px 0 6px}
    input,select,textarea{width:100%;padding:10px;border:1px solid var(--border);border-radius:8px;font:inherit;background:#fff}
    textarea{min-height:90px;resize:vertical}
    .row{display:flex;gap:12px;flex-wrap:wrap}
    .col{flex:1 1 240px}
    .actions{margin-top:16px;display:flex;gap:12px}
    button{padding:10px 14px;border:none;border-radius:8px;background:var(--blue);color:#fff;cursor:pointer}
    button:hover{background:var(--blue2)} button[disabled]{opacity:.6;cursor:not-allowed}
    .hp{position:absolute !important;left:-9999px !important;opacity:0 !important}
    .help{font-size:12px;color:var(--muted)}
    .box{padding:12px;border:1px dashed var(--border);border-radius:8px;background:#fafafa}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <h1>CBA · Formulario de Carga</h1>
      <p class="muted">Rellena uno o ambos formularios. Al enviar, los datos se guardan en nuestra hoja privada.</p>

      <!-- Controles comunes -->
      <div class="row">
        <div class="col">
          <label>Equipo</label>
          <select id="equipo" required>
            <option value="">Selecciona…</option>
            <option value="3FEB" data-cat="M">3FEB (Masculino)</option>
            <option value="Nacional" data-cat="F">Nacional (Femenino)</option>
            <option value="Junior A" data-cat="F">Junior A (Femenino)</option>
          </select>
        </div>
        <div class="col">
          <label>Jugador/a</label>
          <select id="jugador" required>
            <option value="">Primero elige equipo…</option>
          </select>
          <p class="help">La lista se rellena automáticamente según el equipo.</p>
        </div>
        <div class="col">
          <label>Fecha</label>
          <input type="date" id="fecha" required>
        </div>
      </div>
    </div>

    <!-- Wellness -->
    <div class="card">
      <h2>Cuestionario Wellness</h2>
      <form action="https://script.google.com/macros/s/AKfycbwGKdqWco5eautLy5Hyzd7b5_ZFTMf7IBS5sr1tsdu6YW-RIMAU5gOMMXrRIlmq54uZ/exec" method="POST" id="form-wellness">
        <input class="hp" type="text" name="_hp" autocomplete="off">

        <!-- comunes -->
        <input type="hidden" name="equipo" id="w_equipo">
        <input type="hidden" name="nombre" id="w_nombre">
        <input type="hidden" name="fecha" id="w_fecha">
        <input type="hidden" name="tipo" value="wellness">

        <div class="row">
          <div class="col">
            <label>Calidad del sueño (1–5)</label>
            <input type="number" name="sleep" min="1" max="5" required>
          </div>
          <div class="col">
            <label>Fatiga general (1–5)</label>
            <input type="number" name="fatigue" min="1" max="5" required>
          </div>
          <div class="col">
            <label>Nivel de estrés (1–5)</label>
            <input type="number" name="stress" min="1" max="5" required>
          </div>
          <div class="col">
            <label>Estado de ánimo (1–5)</label>
            <input type="number" name="mood" min="1" max="5" required>
          </div>
          <div class="col">
            <label>Dolor muscular (1–5)</label>
            <input type="number" name="doms" min="1" max="5" required>
          </div>
        </div>

        <div id="menstrual-box" class="box" style="display:none; margin-top:12px">
          <label>Fase del ciclo menstrual</label>
          <select name="menstrual">
            <option value="">— No aplica / Prefiero no decir —</option>
            <option value="menstruacion">Menstruación (1–5)</option>
            <option value="folicular_tardia">Folicular tardía (6–14)</option>
            <option value="lutea_temprana">Lútea temprana (15–21)</option>
            <option value="lutea_tardia">Lútea tardía (22–28)</option>
          </select>
          <p class="help">Solo visible en equipos femeninos.</p>
        </div>

        <label>Comentario (opcional)</label>
        <textarea name="comentario" placeholder="¿Algo más que quieras comentar?"></textarea>

        <div class="actions">
          <button type="submit">Enviar Wellness</button>
          <button type="reset">Borrar</button>
        </div>
      </form>
    </div>

    <!-- RPE -->
    <div class="card">
      <h2>Valoración RPE</h2>
      <form action="https://script.google.com/macros/s/AKfycbwGKdqWco5eautLy5Hyzd7b5_ZFTMf7IBS5sr1tsdu6YW-RIMAU5gOMMXrRIlmq54uZ/exec" method="POST" id="form-rpe">
        <input class="hp" type="text" name="_hp" autocomplete="off">

        <!-- comunes -->
        <input type="hidden" name="equipo" id="r_equipo">
        <input type="hidden" name="nombre" id="r_nombre">
        <input type="hidden" name="fecha" id="r_fecha">
        <input type="hidden" name="tipo" value="rpe">

        <div class="row">
          <div class="col">
            <label>RPE (1–10)</label>
            <input type="number" name="rpe" min="1" max="10" required>
          </div>
          <div class="col">
            <label>Comentario de la sesión</label>
            <input type="text" name="comentario_rpe" placeholder="Opcional">
          </div>
        </div>

        <div class="actions">
          <button type="submit">Enviar RPE</button>
          <button type="reset">Borrar</button>
        </div>
      </form>
    </div>
  </div>

  <script>
    // Datos de jugadores por equipo
    const roster = {
      "3FEB": ["Antonio Marín","Adrián Barbeito","Iker Mateo","Jaime Santolaria","Sergio Gutiérrez","Ruben Terrats","Guillermo Campos","Alex Fortes","Alejandro Relaño","Jorge Oliva","Pablo Ballespín"],
      "Nacional": ["Aitana Jerez","Irene Fernandez","Lucía Arnáez","Andrea Rodriguez","Nicole Murugarren","Sofía Barrena","Cristina Sánchez","Iara Bravo"],
      "Junior A": ["Irene Fernandez","Adriana Reyes","Jimena Cachón","Carla Solano","Julia Izquierdo","Alba Masedo","Carla Sánchez","Ainara Testillano","Edurne Diaz","Paola Ramírez","Natalia Allen"]
    };

    const selEquipo = document.getElementById('equipo');
    const selJugador = document.getElementById('jugador');
    const inpFecha = document.getElementById('fecha');
    const menBox = document.getElementById('menstrual-box');

    // Actualiza jugadores y visibilidad de fase menstrual
    selEquipo.addEventListener('change', () => {
      const team = selEquipo.value;
      const isFemale = selEquipo.selectedOptions[0]?.dataset.cat === 'F';
      menBox.style.display = isFemale ? 'box' : 'none';

      selJugador.innerHTML = '<option value="">Selecciona tu nombre…</option>';
      (roster[team] || []).forEach(n => {
        const opt = document.createElement('option');
        opt.value = n; opt.textContent = n;
        selJugador.appendChild(opt);
      });
      syncCommon();
    });

    // Sincroniza campos comunes a ambos formularios
    function syncCommon() {
      document.getElementById('w_equipo').value = selEquipo.value || '';
      document.getElementById('w_nombre').value = selJugador.value || '';
      document.getElementById('w_fecha').value  = inpFecha.value || '';
      document.getElementById('r_equipo').value = selEquipo.value || '';
      document.getElementById('r_nombre').value = selJugador.value || '';
      document.getElementById('r_fecha').value  = inpFecha.value || '';
    }
    ['change','input'].forEach(ev=>{
      selEquipo.addEventListener(ev, syncCommon);
      selJugador.addEventListener(ev, syncCommon);
      inpFecha.addEventListener(ev, syncCommon);
    });
    // Fecha por defecto hoy
    inpFecha.valueAsDate = new Date(); syncCommon();

    // Bloquea envío si faltan equipo/jugador/fecha
    function guard(elForm){
      elForm.addEventListener('submit', (e) => {
        syncCommon();
        const falta = !selEquipo.value || !selJugador.value || !inpFecha.value;
        if (falta) {
          e.preventDefault();
          alert('Selecciona equipo, jugador/a y fecha antes de enviar.');
        }
      });
    }
    guard(document.getElementById('form-wellness'));
    guard(document.getElementById('form-rpe'));
  </script>
</body>
</html>
